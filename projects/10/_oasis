Name: JackCompiler
Version: 0.1
Synopsis: Compiler for Jack language
Authors: Ilya Chukhman <ilya.chukhman@gmail.com> and Dan Genin <dan.genin@gmail.com>
License: LGPL with OCaml linking exception

Description: Allows parsing and executing Jack programs

OASISFormat: 0.4
BuildTools: ocamlbuild
Plugins: META (0.4), DevFiles (0.4)

PreBuildCommand: atdgen -j ./src/parser/grammar.atd; atdgen -t ./src/parser/grammar.atd

# Clean atdgen files
PostCleanCommand: rm -f src/parser/grammar_*

# Enable testing
PostConfCommand: sed -i.bak 's/tests=\"false\"/tests=\"true\"/' setup.data

Library "lexer"
  Path: src/lexer
  Modules: Lexer
  Install: false

Library "parser"
  Path: src/parser
  Modules: Parser
  BuildDepends: lexer, yojson, atdgen
  Install: false

Executable jc
  Path: src/jc
  MainIs: jc.ml
  Build$: flag(tests)
  CompiledObject: best
  BuildDepends: parser, lexer, atdgen
  Install: false

Test test
  Run$: flag(tests)
  Type: Custom (0.4)
  Command: $jc test.jack
